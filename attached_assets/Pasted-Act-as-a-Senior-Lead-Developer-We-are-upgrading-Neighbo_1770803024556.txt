Act as a Senior Lead Developer. We are upgrading "Neighbor Storage" from a prototype to a fully functional Production V2.0.

Your goal is to replace Mock Data with Real Logic (Supabase Auth & DB), implement a Wallet Payment System, and create an Admin Dashboard.

## 1. Upgrade Scope: "Real Interactions"

### A. Authentication (Supabase Auth)
- Replace the dummy login with **Supabase Auth (Email/Password)**.
- **Sign Up Logic:** When a user signs up, trigger a trigger/function to create a row in the `public.users` table with default values (`balance = 0`, `trust_score = 36.5`).
- **Profile Management:** Allow users to update their Avatar and Nickname, saving to Supabase.

### B. Wallet Payment System (The "Neighbor Money")
Since we cannot use real Credit Card APIs in this environment, implement a **"Wallet/Point System"**.
1.  **My Wallet Screen:**
    - Show Current Balance (KRW).
    - **[Top Up] Button:** Simulates charging money (e.g., adds 50,000 KRW to balance instantly for testing).
    - **[Withdraw] Button:** Requests a withdrawal (Admin must approve).
2.  **Payment Logic (Checkout):**
    - Check if `User Balance >= (Rental Fee + Deposit)`.
    - If yes, deduct the amount.
    - **Escrow Logic:** The `Rental Fee` goes to the "Platform Account" (temporarily), and `Deposit` goes to "Escrow State".
3.  **Transaction History:** Create a list showing all + (Charge/Earn) and - (Spend/Deposit) history.

### C. The Rental Lifecycle (State Machine)
Implement a strict status flow in the **Chat Room Header** & **Item Detail**:
1.  **REQUESTED:** Borrower taps "Rent Request".
2.  **ACCEPTED:** Owner accepts. Borrower sees "Pay Now" button.
3.  **PAID (Active):** Money deducted. Deposit held. Rental period starts.
4.  **RETURNED:** Borrower marks as "Returned". Owner sees "Confirm Return".
5.  **COMPLETED:** Owner confirms.
    - **Result:** `Deposit` returned to Borrower. `Rental Fee` transferred to Owner's wallet.

### D. Admin Dashboard (Web View)
Create a separate page accessible only if `user.role == 'admin'` (or via a secret route `/admin-dashboard`).
- **Dashboard:** Total Users, Total Active Rentals, Total Money Held.
- **User Manager:** List all users, Ban/Unban buttons.
- **Item Manager:** List all items, Delete illegal items.
- **Transaction Manager:** See all financial flows.

---

## 2. Revised Database Schema (Supabase SQL)

Please update the SQL logic to support these features:

```sql
-- Enhanced Users Table
create table users (
  id uuid primary key references auth.users,
  email text,
  nickname text,
  avatar_url text,
  balance int default 0, -- Wallet Balance
  trust_score float default 36.5,
  is_admin boolean default false,
  created_at timestamptz default now()
);

-- Transaction Ledger
create table transactions (
  id bigint generated by default as identity primary key,
  user_id uuid references users(id),
  type text, -- 'CHARGE', 'PAYMENT', 'REFUND', 'EARNING', 'WITHDRAW'
  amount int, -- Positive or Negative
  description text,
  created_at timestamptz default now()
);

-- Reviews
create table reviews (
  id bigint generated by default as identity primary key,
  rental_id bigint references rentals(id),
  reviewer_id uuid references users(id),
  target_id uuid references users(id),
  score int, -- 1 to 5
  comment text
);